<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nico">

<title>Mise en route d’un&nbsp;ESP8266-01 – ouilogique.com</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<link href="../../favicon.ico" rel="icon">
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer",
    "search-label": "Recherche"
  }
}</script>


</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
          <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text"><i class="fa-regular fa-house" aria-label="house"></i></span></a>
  </li>  
</ul>
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Mise en route d’un&nbsp;ESP8266-01</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Auteur·rice</div>
    <div class="quarto-title-meta-contents">
             <p>Nico </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Date de publication</div>
    <div class="quarto-title-meta-contents">
      <p class="date">13 août 2016</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p>L’ESP-01 présenté ici, m’a été transmis par <a href="http://didel.com/">Didel</a>. Donc merci à Jean-Daniel Nicoud.</p>
</blockquote>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./images/esp8266-01.jpg" class="lightbox" data-glightbox="description: .lightbox-desc-1" data-gallery="quarto-lightbox-gallery-1" title="ESP8266-01"><img src="./images/esp8266-01.jpg" class="img-fluid figure-img" alt="ESP8266-01"></a></p>
<figcaption>ESP8266-01</figcaption>
</figure>
</div>
<section id="lesp8266-01" class="level2">
<h2 class="anchored" data-anchor-id="lesp8266-01">L’ESP8266-01</h2>
<p>L’ESP8266-01 est un SoC (<em>System on Chip</em>) qui contient un microcontrôleur et un système WiFi. Il ne fonctionne qu’en 3.3&nbsp;V et n’est pas tolérant au 5&nbsp;V. Il a deux GPIO (0 &amp; 2) qui peuvent être utilisés pour la communication I²C. Il est pourvu d’un port RS232 qu’on peut utiliser pour lui envoyer des commandes&nbsp;AT. Dans ce tuto, je présente deux façons différentes d’utiliser cet ESP&nbsp;:</p>
<ul>
<li><a href="#programmation-avec-descommandesat">En lui envoyant des commandes AT sur son port RS232 avec un ordinateur ou un microcontrôleur.</a></li>
<li><a href="#programmation-du-microcontrleur-de-lesp-01-en-arduinoc">En programmant directement son microcontrôleur interne en Arduino&nbsp;C.</a></li>
</ul>
<p>Pour la première partie sur les commandes AT, <a href="http://nodemcu.com/index_en.html" rel="nofollow">le firmware NodeMCU</a> doit être installé sur l’ESP. C’est en général le cas pour les ESP neufs.</p>
<p>Lorsque l’ESP est programmé en Arduino&nbsp;C, cela écrase le firmware NodeMCU, mais rien n’est perdu, <a href="#revenir--nodemcu">on peut le flasher à nouveau</a>.</p>
<p>À noter encore que NodeMCU ne permet pas seulement d’utiliser les commandes AT, mais permet également de programmer l’ESP dans le langage Lua, mais ce n’est pas l’objet de ce tuto.</p>
</section>
<section id="programmation-avec-des-commandes-at" class="level2">
<h2 class="anchored" data-anchor-id="programmation-avec-des-commandes-at">Programmation avec des&nbsp;commandes&nbsp;AT</h2>
<p>Sur le web, on trouve surtout des tutos qui décrivent la solution utilisant les commandes AT. À mon avis c’est du gâchis, car ces commandes ne donnent accès qu’à une petite partie des fonctionnalités de ce SoC et nécessitent d’utiliser un microcontrôleur externe alors même que l’ESP en contient déjà un de très bonne facture. Cependant, les commandes AT peuvent être utiles pour des premiers tests.</p>
<blockquote class="blockquote">
<p>Les commandes&nbsp;AT peuvent vite être très limitantes car il faudra prévoir toutes les réponses possibles et le programme deviendra donc vite très complexe. En plus ces commandes évoluent avec les versions des firmwares. Donc la compatibilité n’est pas assurée.</p>
</blockquote>
<p>L’idée est d’utiliser un ordi avec <a href="http://freeware.the-meiers.org/">CoolTerm</a> pour envoyer quelques commandes&nbsp;AT à l’ESP-01. Comme je n’ai pas de bridge USB-RS232, j’utilise <a href="../../NodeMCU_esp8266_amica/" rel="nofollow">un module ESP-12E Amica</a> sur lequel j’ai connecté la broche RST au GND pour que l’ESP-12E ne démarre pas. Ainsi les commandes envoyées de l’ordi se retrouvent directement sur les broches TX et RX de l’ESP-12E. Ce montage peut être schématiquement représenté de la façon suivante&nbsp;:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ordi</span> TX <span class="at">-------</span>   <span class="at">-</span> ESP8266-12E TX <span class="at">-------</span> ESP8266-01 TX</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               <span class="ex">\/</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               <span class="ex">/</span><span class="dt">\</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="ex">ordi</span> RX <span class="at">-------</span>   <span class="at">-</span> ESP8266-12E RX <span class="at">-------</span> ESP8266-01 RX</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>On voit que le TX de l’ESP-12E doit être connecté au TX de l’ESP-01 et inversement pour le RX.</p>
<p><strong>Il est important de comprendre que l’ESP-12E est utilisé comme un bridge USB-RS232 et pas pour ses fonctionnalités WiFi.</strong> J’aurais pu utiliser un Arduino, mais je n’ai que des modules 5&nbsp;V. Donc j’ai préféré l’ESP-12E qui lui fonctionne en 3.3&nbsp;V.</p>
<section id="câblage-de-lesp-01" class="level3">
<h3 class="anchored" data-anchor-id="câblage-de-lesp-01">Câblage de l’ESP-01</h3>
<ul>
<li>Pour VCC et GND, il est nécessaire d’utiliser une alimentation 3.3&nbsp;V externe, car l’ESP-01 peut être très gourmant (~300&nbsp;mA), particulièrement lorsque le WiFi se met en route.</li>
<li>La broche CH<em>PD (_chip power-down</em>) doit être obligatoirement mise à VCC pour que le module soit actif.</li>
<li>Optionnellement, on peut aussi mettre RST à VCC pour s’assurer qu’il n’y a pas de <em>reset</em> intempestifs. Ou connecter RST avec une pull-up de 10&nbsp;kΩ à VCC et un bouton poussoir à GND.</li>
<li>Connecter TX au TX de l’ESP-12E</li>
<li>Connecter RX au RX de l’ESP-12E</li>
</ul>
</section>
<section id="câblage-de-lesp-12e-utilisé-comme-bridge-usb-rs232" class="level3">
<h3 class="anchored" data-anchor-id="câblage-de-lesp-12e-utilisé-comme-bridge-usb-rs232">Câblage de l’ESP-12E<br>(utilisé comme bridge USB-RS232)</h3>
<ul>
<li>Mettre RST à GND pour que l’ESP-12E ne démarre pas.</li>
<li>Connecter TX au TX de l’ESP-01</li>
<li>Connecter RX au RX de l’ESP-01</li>
</ul>
</section>
<section id="câblage-sur-breadboard" class="level3">
<h3 class="anchored" data-anchor-id="câblage-sur-breadboard">Câblage sur breadboard</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./images/esp8266-01_pinout.jpg" class="lightbox" data-glightbox="description: .lightbox-desc-2" data-gallery="quarto-lightbox-gallery-2" title="ESP8266-01 brochage"><img src="./images/esp8266-01_pinout.jpg" class="img-fluid figure-img" alt="ESP8266-01 brochage"></a></p>
<figcaption>ESP8266-01 brochage</figcaption>
</figure>
</div>
<p>Note&nbsp;: Les LED rouge et verte ne sont pas connectées.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./images/esp8266-01_montage_commandes_AT_lowres.jpg" class="lightbox" data-glightbox="description: .lightbox-desc-3" data-gallery="quarto-lightbox-gallery-3" title="ESP8266-01 brochage"><img src="./images/esp8266-01_montage_commandes_AT_lowres.jpg" class="img-fluid figure-img" alt="ESP8266-01 brochage"></a></p>
<figcaption>ESP8266-01 brochage</figcaption>
</figure>
</div>
</section>
<section id="utilisation-de-coolterm" class="level3">
<h3 class="anchored" data-anchor-id="utilisation-de-coolterm">Utilisation de CoolTerm</h3>
<p>Dans les options de CoolTerm, choisir une vitesse de transmission (9600 ou 115200&nbsp;bauds). Si les commandes ci-dessous ne passent pas, modifier la vitesse. Dans mon cas, ça marche à 115200&nbsp;bauds. Les commandes doivent être terminées avec CR + LF. Dans CoolTerm, il n’y a rien à configurer, par contre si on utilise le moniteur série de l’IDE Arduino au lieu de CoolTerm, il faut sélectionner l’option <code>Les deux, NL et CR</code>.</p>
<p>La première commande à tester est</p>
<pre><code>AT</code></pre>
<p>Et l’ESP doit répondre</p>
<pre><code>OK</code></pre>
<p>Ensuite on peut envoyer un <em>reset</em></p>
<pre><code>AT+RST</code></pre>
<p>et l’ESP répond</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./images/coolterm-esp01_1.png" class="lightbox" data-glightbox="description: .lightbox-desc-4" data-gallery="quarto-lightbox-gallery-4" title="ESP8266-01 réponse commande AT+RST"><img src="./images/coolterm-esp01_1.png" class="img-fluid figure-img" alt="ESP8266-01 réponse commande AT+RST"></a></p>
<figcaption>ESP8266-01 réponse commande AT+RST</figcaption>
</figure>
</div>
<p>Enfin, il peut être utile de savoir quelle version du firmware est installée avec la commande</p>
<pre><code>AT+GMR</code></pre>
<p>Sur mon ESP, la réponse est</p>
<pre><code>AT version:0.40.0.0(Aug  8 2015 14:45:58)
SDK version:1.3.0
Ai-Thinker Technology Co.,Ltd.
Build:1.3.0.2 Sep 11 2015 11:48:04
OK</code></pre>
</section>
<section id="utilisation-dautres-moniteurs-série" class="level3">
<h3 class="anchored" data-anchor-id="utilisation-dautres-moniteurs-série">Utilisation d’autres moniteurs série</h3>
<p>À la place de CoolTerm, on peut utiliser n’importe quel autre logiciel, comme le moniteur série de l’IDE Arduino ou <a href="http://esp8266.ru/esplorer/">ESPlorer</a></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./images/moniteur_serie_ide_arduino.png" class="lightbox" data-glightbox="description: .lightbox-desc-5" data-gallery="quarto-lightbox-gallery-5" title="Moniteur série de l’IDE Arduino"><img src="./images/moniteur_serie_ide_arduino.png" class="img-fluid figure-img" alt="Moniteur série de l’IDE Arduino"></a></p>
<figcaption>Moniteur série de l’IDE Arduino</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./images/esplorer.png" class="lightbox" data-glightbox="description: .lightbox-desc-6" data-gallery="quarto-lightbox-gallery-6" title="ESPlorer"><img src="./images/esplorer.png" class="img-fluid figure-img" alt="ESPlorer"></a></p>
<figcaption>ESPlorer</figcaption>
</figure>
</div>
</section>
<section id="à-lire-aussi" class="level3">
<h3 class="anchored" data-anchor-id="à-lire-aussi">À lire aussi</h3>
<p><a href="https://cdn.sparkfun.com/assets/learn_tutorials/4/0/3/4A-ESP8266__AT_Instruction_Set__EN_v0.30.pdf">Sparkfun a un PDF avec toutes les commandes&nbsp;AT possibles.</a></p>
<p>Pour continuer avec les commandes&nbsp;AT, lire les pages suivantes&nbsp;:</p>
<ul>
<li><a href="https://alselectro.wordpress.com/2015/05/05/wifi-module-esp8266-1-getting-started-with-at-commands/">alselectro — WiFi Module ESP8266 – 1. Getting started with AT commands</a></li>
<li><a href="https://alselectro.wordpress.com/2015/05/13/wifi-module-esp8266-2-tcp-client-server-mode/">alselectro — WiFi Module ESP8266 – 2. TCP CLIENT /Server mode</a></li>
</ul>
<p>J’ai compilé les informations de ces deux pages télégraphiquement ici&nbsp;:</p>
<p><a href="../2016-08-13-esp_commandes_at_utiles/">../2016-08-13-esp_commandes_at_utiles/</a></p>
<p>Il y a également des informations intéressantes sur ces pages&nbsp;:</p>
<ul>
<li><a href="http://blog.nicolasc.eu/esp8266-premiere-partie-generalites/">Nicolas C. Blog — ESP8266 première partie : Généralités</a></li>
<li><a href="http://blog.nicolasc.eu/esp8266-seconde-partie-le-mode-standalone/">Nicolas C. Blog — ESP8266 seconde partie : Le mode Standalone</a></li>
</ul>
</section>
</section>
<section id="programmation-du-microcontrôleur-de-lesp-01-en-arduino-c" class="level2">
<h2 class="anchored" data-anchor-id="programmation-du-microcontrôleur-de-lesp-01-en-arduino-c">Programmation du microcontrôleur de l’ESP-01 en Arduino&nbsp;C</h2>
<section id="préalable" class="level3">
<h3 class="anchored" data-anchor-id="préalable">Préalable</h3>
<p>Comme la programmation avec l’IDE Arduino va écraser le firmware NodeMCU préinstallé sur l’ESP, il peut être utile de noter la réponse de la commande <code>AT+GMR</code> quelque part. Ceci permettra de retrouver la configuration d’origine si nécessaire.</p>
</section>
<section id="préparation-de-lide-arduino" class="level3">
<h3 class="anchored" data-anchor-id="préparation-de-lide-arduino">Préparation de l’IDE Arduino</h3>
<p>La procédure pour préparer l’IDE Arduino à la programmation d’un ESP-01 est la même que pour un ESP-12E&nbsp;:</p>
<p><a href="../../NodeMCU_esp8266/#programmation-de-lesp8266-en-arduino-c">ouilogique.com — Programmation de l’ESP8266 en Arduino C</a></p>
<p>J’ai utilisé <a href="https://www.arduino.cc/en/Main/OldSoftwareReleases#previous">la version 1.6.9 de l’IDE Arduino</a> pour ces tests.</p>
<p>Les réglages de l’IDE sont les suivants&nbsp;:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./images/esp8266-01_parametres_ide_arduino.png" class="lightbox" data-glightbox="description: .lightbox-desc-7" data-gallery="quarto-lightbox-gallery-7" title="Paramètres de l’IDE Arduino pour la programmation de l’ESP8266-01"><img src="./images/esp8266-01_parametres_ide_arduino.png" class="img-fluid figure-img" alt="Paramètres de l’IDE Arduino pour la programmation de l’ESP8266-01"></a></p>
<figcaption>Paramètres de l’IDE Arduino pour la programmation de l’ESP8266-01</figcaption>
</figure>
</div>
<p>Deux paramètres sont spécialement importants&nbsp;:</p>
<ul>
<li>Le paramètre “Type de carte” doit être réglé à “Generic ESP8266 Module”.</li>
<li>Le paramètre “Flash size” doit être réglé en fonction de l’ESP utilisé. Le programme de test <a href="https://github.com/NicHub/ouilogique-ESP8266-Arduino/blob/master/get-esp8266-info/get-esp8266-info.ino">get-esp8266-info.ino</a> permettra de lire les informations de l’ESP.</li>
</ul>
</section>
<section id="câblage" class="level3">
<h3 class="anchored" data-anchor-id="câblage">Câblage</h3>
<p>Lors de la programmation, GPIO&nbsp;0 doit être tiré à la masse. Par mesure de précaution, il est préférable de mettre une résistance de 330&nbsp;Ω en série qui évitera des dégâts si d’aventure GPIO&nbsp;0 venait à prendre un état logique haut lors de la programmation. Sur l’image ci-dessous, on voit que le fil bleu peut être déplacé en mode programmation vers la résistance de 330&nbsp;Ω (colonne 39 du breadboard) ou en mode utilisation vers la LED rouge (colonne 41). La broche RST peut être mise à la masse à l’aide du fil blanc, ce qui permet de redémarrer l’ESP. Toutes les autres connexions sont identiques que pour la programmation AT.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./images/esp8266-01_montage_programmation_lowres.jpg" class="lightbox" data-glightbox="description: .lightbox-desc-8" data-gallery="quarto-lightbox-gallery-8" title="Montage programmation ESP8266-01"><img src="./images/esp8266-01_montage_programmation_lowres.jpg" class="img-fluid figure-img" alt="Montage programmation ESP8266-01"></a></p>
<figcaption>Montage programmation ESP8266-01</figcaption>
</figure>
</div>
</section>
<section id="procédure-de-programmation" class="level3">
<h3 class="anchored" data-anchor-id="procédure-de-programmation">Procédure de programmation</h3>
<ul>
<li>Déconnecter les alimentations</li>
<li>Mettre GPIO&nbsp;0 à la masse</li>
<li>Reconnecter les alimentations</li>
<li>Compiler et téléverser le programme <a href="https://github.com/NicHub/ouilogique-ESP8266-Arduino/blob/master/get-esp8266-info/get-esp8266-info.ino">get-esp8266-info.ino</a></li>
<li>Déconnecter les alimentations</li>
<li>Connecter GPIO&nbsp;0 à la LED rouge</li>
<li>Reconnecter les alimentations</li>
</ul>
<p>Voici les résultats de <a href="https://github.com/NicHub/ouilogique-ESP8266-Arduino/blob/master/get-esp8266-info/get-esp8266-info.ino">get-esp8266-info.ino</a> pour mon ESP-01. On voit que <code>ESP.getFlashChipRealSize()</code> retourne 1&nbsp;Mo (1048576 octets). C’est donc la valeur maximum que l’on peut utiliser pour le paramètre “Flash Size” de l’IDE Arduino.</p>
<pre><code>ESP8266 INFORMATION
===================
ESP.getFreeHeap()              : 46000
ESP.getChipId()                : 0xD48ED5
ESP.getSdkVersion()            : 1073644416
ESP.getBootVersion()           : 4
ESP.getBootMode()              : 1
ESP.getCpuFreqMHz()            : 80
ESP.getFlashChipId()           : 0x1440E0
ESP.getFlashChipRealSize()     : 1048576
ESP.getFlashChipSize()         : 1048576
ESP.getFlashChipSpeed()        : 40000000
ESP.getFlashChipMode()         : 2
ESP.getFlashChipSizeByChipId() : 0x100000
ESP.getSketchSize()            : 231264
ESP.getFreeSketchSpace()       : 270336
ESP.getCycleCount()            : 23327555
ESP.getResetInfoPtr()
6
0
0
0
0
0
0</code></pre>
</section>
<section id="programme-simple-websocket.ino" class="level3">
<h3 class="anchored" data-anchor-id="programme-simple-websocket.ino">Programme <code>simple-websocket.ino</code></h3>
<p>Si le programme <a href="https://github.com/NicHub/ouilogique-ESP8266-Arduino/blob/master/get-esp8266-info/get-esp8266-info.ino">get-esp8266-info.ino</a> a fonctionné, on peut maintenant jouer avec le WiFi grâce au programme <a href="https://github.com/NicHub/ouilogique-ESP8266-Arduino/tree/master/simple-websocket">simple-websocket.ino</a>.</p>
<p>La procédure de mise en route est indiquée dans le README du programme. Il y a deux lignes à modifier suivant le type d’ESP utilisé&nbsp;:</p>
<p>ligne 26 de <code>ws_functions.h</code>, indiquer <code>#define ESP_MODULE_TYPE 'ESP-01'</code></p>
<p>ligne 7 de <code>websocket.js</code>, indiquer <code>var ESP_MODULE_TYPE = 'ESP-01'</code></p>
<p>Et si tout à fonctionné, voici ce que le navigateur doit montrer&nbsp;:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://github.com/NicHub/ouilogique-ESP8266-Arduino/raw/master/simple-websocket/images/simple-websocket-screenshot-01.png" class="lightbox" data-glightbox="description: .lightbox-desc-9" data-gallery="quarto-lightbox-gallery-9" title="Capture d’écran simple-websocket.ino"><img src="https://github.com/NicHub/ouilogique-ESP8266-Arduino/raw/master/simple-websocket/images/simple-websocket-screenshot-01.png" class="img-fluid figure-img" alt="Capture d’écran simple-websocket.ino"></a></p>
<figcaption>Capture d’écran simple-websocket.ino</figcaption>
</figure>
</div>
</section>
<section id="à-lire-aussi-1" class="level3">
<h3 class="anchored" data-anchor-id="à-lire-aussi-1">À lire aussi</h3>
<ul>
<li><a href="https://www.hackster.io/rayburne/esp8266-01-using-arduino-ide-67a124" rel="nofollow">hackster.io — Ray Burnette — ESP8266-01 using Arduino IDE</a></li>
<li><a href="http://www.allaboutcircuits.com/projects/breadboard-and-program-an-esp-01-circuit-with-the-arduino-ide/">allaboutcircuits.com — Charles R. Hampton — Breadboard and Program an ESP-01 Circuit with the Arduino IDE</a></li>
<li><a href="http://playground.boxtec.ch/doku.php/wireless/esp8266">playground.boxtec.ch — ESP8266 WiFi Module</a></li>
</ul>
</section>
</section>
<section id="revenir-à-nodemcu" class="level2">
<h2 class="anchored" data-anchor-id="revenir-à-nodemcu">Revenir à NodeMCU</h2>
<p>Voir <a href="../../NodeMCU_esp8266/#mise--jour-du-firmware">ouilogique.com — Mise à jour du firmware</a></p>


<div class="hidden" aria-hidden="true">
<span class="glightbox-desc lightbox-desc-1">ESP8266-01</span>
<span class="glightbox-desc lightbox-desc-2">ESP8266-01 brochage</span>
<span class="glightbox-desc lightbox-desc-3">ESP8266-01 brochage</span>
<span class="glightbox-desc lightbox-desc-4">ESP8266-01 réponse commande AT+RST</span>
<span class="glightbox-desc lightbox-desc-5">Moniteur série de l’IDE Arduino</span>
<span class="glightbox-desc lightbox-desc-6">ESPlorer</span>
<span class="glightbox-desc lightbox-desc-7">Paramètres de l’IDE Arduino pour la programmation de l’ESP8266-01</span>
<span class="glightbox-desc lightbox-desc-8">Montage programmation ESP8266-01</span>
<span class="glightbox-desc lightbox-desc-9">Capture d’écran simple-websocket.ino</span>
</div>
</section>

<p>© ouilogique.com</p></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../index.html">
<p><i class="fa-regular fa-house" aria-label="house"></i></p>
</a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>
<script src="../../js/file_list.js"></script>
<script src="../../js/prev_next_buttons.js"></script>
<script src="../../js/target_blank.js"></script>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","selector":".lightbox","openEffect":"zoom","loop":false,"descPosition":"bottom"});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>




</body></html>