<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nico">

<title>Installer Raspberry Pi OS sur Raspberry Pi sans clavier, ni souris, ni écran – ouilogique.com</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<link href="../.././images/favicon.ico" rel="icon">
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer",
    "search-label": "Recherche"
  }
}</script>


</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand navbar-dark ">
      <div class="navbar-container container-fluid">
          <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text"><i class="fa-regular fa-house" aria-label="house"></i></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/NicHub" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Installer Raspberry Pi OS sur Raspberry Pi sans clavier, ni souris, ni écran</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Auteur·rice</div>
    <div class="quarto-title-meta-contents">
             <p>Nico </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Date de publication</div>
    <div class="quarto-title-meta-contents">
      <p class="date">9 mars 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>


<p>Cet article montre comment configurer un Raspberry de A à Z à l’aide d’un ordinateur standard. Le Raspberry sera donc en mode <em>headless</em>, c’est-à-dire sans clavier, ni souris, ni écran.</p>
<blockquote class="blockquote">
<p>N.B. L’article original, écrit en août 2017, s’intitulait “Installer Raspian Stretch sur Raspberry Pi” et était accessible à cette URL&nbsp;: <a href="https://ouilogique.com/installer-raspian-stretch/" class="uri">https://ouilogique.com/installer-raspian-stretch/</a> qui est maintenant redirigée vers l’URL actuelle.</p>
</blockquote>
<section id="matériel-utilisé-pour-cette-procédure" class="level2">
<h2 class="anchored" data-anchor-id="matériel-utilisé-pour-cette-procédure">Matériel utilisé pour cette procédure</h2>
<ul>
<li>Un Raspberry Pi modèle 2 (ou plus)</li>
<li>Une carte SD (32&nbsp;GB recommandés)</li>
<li>Un ordinateur standard</li>
<li>Un routeur (optionnel, on peut connecter le Rpi directement sur le port Ethernet)</li>
<li>Un câble Ethernet</li>
</ul>
</section>
<section id="préparation-15-min" class="level2">
<h2 class="anchored" data-anchor-id="préparation-15-min">Préparation (~15&nbsp;min)</h2>
<blockquote class="blockquote">
<p>N.B. Ce chapitre a été mis a jour en mars 2023</p>
</blockquote>
</section>
<section id="choix-de-los" class="level2">
<h2 class="anchored" data-anchor-id="choix-de-los">Choix de l’OS</h2>
<p>Anciennement, l’OS du Raspberry s’appelait <em>Raspbian</em> ce qui était logique puisqu’il est basé sur <em>Debian</em>. On devait le télécharger séparément et l’installer avec un programme qui s’appelait <em>Etcher</em>.</p>
<p>Aujourd’hui, les choses sont un peu différentes. <em>Etcher</em> a été remplacé par <em>Raspberry Pi Imager</em> et on a plus besoin de télécharger l’OS séparément, car c’est le programme qui s’en charge. Il peut être téléchargé ici&nbsp;:</p>
<ul>
<li><a href="https://www.raspberrypi.com/software/" class="uri">https://www.raspberrypi.com/software/</a></li>
</ul>
<p>On a le choix entre plusieurs moutures de l’OS. Celle que je préfère est la version “Raspberry Pi OS (64-bit)”. La raison est que j’ai besoin d’un OS 64&nbsp;bit pour faire tourner Prince (<a href="https://www.princexml.com/" class="uri">https://www.princexml.com/</a>). En cas de doute, il vaut mieux choisir l’OS recommandé, c’est-à-dire “Raspberry Pi OS (32-bit)”.</p>
</section>
<section id="choix-du-terminal" class="level2">
<h2 class="anchored" data-anchor-id="choix-du-terminal">Choix du terminal</h2>
<p>Si vous êtes sur macOS ou n’importe quel système *nix, le choix est vite fait, il suffit d’utiliser le terminal par défaut. Ça ne veut pas dire qu’il n’y a qu’une possibilité, mais qu’il y a de fortes chances que vous sachiez déjà quel terminal choisir.</p>
<p>Par contre si vous êtes sur Windows, il y a de fortes chances que vous ne sachiez pas quel terminal choisir. Donc voici quelques possibiltés.</p>
<ul>
<li>Windows PowerShell (intégré à Windows)</li>
<li>COMMAND.COM (cmd) (intégré à Windows)</li>
<li><a href="https://git-scm.com/">MinGW – Git Bash installé avec Git</a></li>
<li><a href="https://www.cygwin.com/">Cygwin</a></li>
<li><a href="https://putty.org/">PuTTY</a></li>
</ul>
</section>
<section id="procédure-dinstallation-30-min" class="level2">
<h2 class="anchored" data-anchor-id="procédure-dinstallation-30-min">Procédure d’installation (~30&nbsp;min)</h2>
<ul>
<li><p>Sur un ordinateur standard (pas le Raspeberry), <a href="https://www.raspberrypi.com/software/">télécharger <em>Raspberry Pi Imager</em></a> et l’installer.</p></li>
<li><p>Dans <em>Raspberry Pi Imager</em>, cliquer sur “Système d’exploitation” et <a href="#choix-de-los">sélectionner l’OS de votre choix</a>.</p></li>
<li><p>Insérer une carte SD, cliquer sur “Choisir le stockage” et choisir la carte SD.</p></li>
<li><p><strong>Important&nbsp;:</strong> Cliquer sur la roue dentée et s’assurer que l’option “Activer SSH” est activée.</p>
<blockquote class="blockquote">
<p>Anciennement, l’activation de SSH se faisant en créant un fichier vide appelé <code>ssh</code>dans le répertoire <code>boot</code>, par exemple avec la commande <code>touch /Volumes/boot/ssh</code>. Ce n’est plus nécessaire aujourd’hui.</p>
</blockquote></li>
<li><p>Cliquer sur “ÉCRIRE”. Entrez votre mot de passe lorsque le dialogue le demande. L’écriture de l’image disque prend environ 10&nbsp;min avec la vérification (si elle a été sélectionnée dans les préférences). Ces temps peuvent beaucoup varier en fonction de votre matériel.</p></li>
<li><p>Éjecter la carte SD.</p></li>
<li><p>Insérer la carte SD dans le Raspberry éteint.</p></li>
<li><p>Connecter le câble Ethernet.</p></li>
<li><p>Brancher le câble d’alimentation du Raspberry.</p></li>
<li><p>Après environ 30&nbsp;secondes, ouvrir un terminal et se connecter au Raspberry avec la commande<br> <code>ssh pi@raspberrypi.local</code>. Le mot de passe par défaut est <code>raspberry</code>. Si SSH renvoie l’erreur “WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!”, c’est parce qu’une entrée existe déjà pour <code>raspberrypi.local</code> dans le fichier <code>~/.ssh/known_hosts</code> (ou sur Windows <code>%HOMEPATH%\.ssh\known_hosts</code>) de l’ordinateur hôte (pas le RPi). Donc pour aller plus loin, il faut supprimer les lignes qui commencent par <code>raspberrypi.local</code> dans le fichier <code>known_hosts</code>.</p></li>
</ul>
</section>
<section id="retrouver-un-appareil-sur-le-réseau-local" class="level2">
<h2 class="anchored" data-anchor-id="retrouver-un-appareil-sur-le-réseau-local">Retrouver un appareil sur le réseau local</h2>
<p>Si on doit retrouver un Raspberry sur le réseau, la première commande à essayer est<br> <code>ping -c1 raspberrypi.local</code>. Mais si on ne connait pas le nom du Raspberry, alors il faut balayer toutes les adresses possibles (<em>network scan</em>). Il y a deux commandes utiles pour cela, <code>arp</code> et <code>nmap</code>. Sur la commande <code>nmap</code> doit être installée via Homebrew. Pour ceux qui préfèrent les GUI, il y a aussi <a href="https://nmap.org/zenmap/">Zenmap</a>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">arp</span> <span class="at">-a</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nmap</span> <span class="at">-sP</span> 192.168.1.0/24</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="mise-à-jour-de-raspbian" class="level2">
<h2 class="anchored" data-anchor-id="mise-à-jour-de-raspbian">Mise à jour de Raspbian</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt-get update <span class="at">--assume-yes</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt-get upgrade <span class="at">--assume-yes</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt-get dist-upgrade <span class="at">--assume-yes</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt-get autoremove <span class="at">--assume-yes</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<blockquote class="blockquote">
<p><strong>Explications</strong> &gt; <br>sources <br>- <a href="https://www.lecoindunet.com/difference-apt-update-upgrade-full-upgrade" class="uri">https://www.lecoindunet.com/difference-apt-update-upgrade-full-upgrade</a> &gt; <br>- <a href="https://askubuntu.com/a/527421/949794" class="uri">https://askubuntu.com/a/527421/949794</a> &gt; <br><code>sudo apt-get update</code>&nbsp;: Télécharge les informations des paquets à partir des sources configurées <br><code>sudo apt-get upgrade</code>&nbsp;: Mets à jour les paquets installés sans en supprimer. <br><code>sudo apt-get dist-upgrade</code>&nbsp;: Installe les versions candidates des paquets installés en installant ou en supprimant d’autres paquets si nécessaire. <br><code>sudo apt-get autoremove</code>&nbsp;: Supprime les dépendances qui ne sont plus utilisées.</p>
</blockquote>
</section>
<section id="configuration" class="level2">
<h2 class="anchored" data-anchor-id="configuration">Configuration</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nano</span> ~/.bash_profile</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Copier-coller les commandes suivantes dans .bash_profile</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="va">PS1</span><span class="op">=</span><span class="st">$'</span><span class="dt">\n\n\xf0\x9f\x98\xBA</span><span class="st">'"  \t – \[\033[01;32m\]\u@\h\[\033[00m\]:\W &gt; "</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="bu">alias</span> ll=<span class="st">'ls -lGhF'</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="bu">alias</span> la=<span class="st">'ll -a'</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="bu">alias</span> gs=<span class="st">'git status'</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="bu">alias</span> lsserial=<span class="st">'python3 -m serial.tools.list_ports'</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="va">IP</span><span class="op">=</span><span class="va">$(</span><span class="fu">hostname</span> <span class="at">-I</span> <span class="kw">|</span> <span class="fu">awk</span> <span class="st">'{print $1}'</span><span class="va">)</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="bu">alias</span> pyserver=<span class="st">'PORT=4000; echo -e "\nhttp://localhost:$PORT"; echo -e "http://$IP:$PORT\n"; /usr/bin/python3 -m http.server $PORT'</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="va">TIMEFORMAT</span><span class="op">=</span><span class="st">$'</span><span class="dt">\n</span><span class="st">Elapsed time: %E'</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">###</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create virtual environment for python3 (once)</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># cd $HOME &amp;&amp; python3 -m venv pyenv</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># and activate it (for each terminal)</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">##</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="va">VENVPATH</span><span class="op">=</span><span class="st">"</span><span class="va">$HOME</span><span class="st">/pyenv/bin/activate"</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">[[</span> <span class="ot">-f</span> <span class="st">"</span><span class="va">$VENVPATH</span><span class="st">"</span> <span class="kw">]];</span> <span class="cf">then</span> <span class="bu">source</span> <span class="st">"</span><span class="va">$VENVPATH</span><span class="st">"</span><span class="kw">;</span> <span class="cf">fi</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co"># If Byobu is installed, launch it at startup.</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="kw">[[</span> <span class="ot">-f</span> /usr/bin/byobu-launch <span class="kw">]]</span> <span class="kw">&amp;&amp;</span> <span class="va">_byobu_sourced</span><span class="op">=</span>1 <span class="bu">.</span> /usr/bin/byobu-launch <span class="dv">2</span><span class="op">&gt;</span>/dev/null <span class="kw">||</span> <span class="fu">true</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> ~/.bash_profile</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> raspi-config</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Update</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Advanced Options / Expand filesystem</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="ssh" class="level2">
<h2 class="anchored" data-anchor-id="ssh">SSH</h2>
<p><strong>Sur l’ordinateur hôte</strong></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Si le fichier ~/.ssh/id_rsa.pub n’existe pas,</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># il faut le créer avec `ssh-keygen`.</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ssh-keygen</span> <span class="co"># Accepter toutes les valeurs par défaut.</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> ~/.ssh/id_rsa.pub <span class="co"># + Copier le résultat dans le presse-papier.</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Sur le RPi</strong></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> ~/.ssh</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">chmod</span> 700 ~/.ssh</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nano</span> ~/.ssh/authorized_keys <span class="co"># + Coller la clé de l’hôte à la fin du fichier.</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">chmod</span> 644 ~/.ssh/authorized_keys</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="permissions-de-fichiers-courants" class="level2">
<h2 class="anchored" data-anchor-id="permissions-de-fichiers-courants">Permissions de fichiers courants</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chmod</span> 700 ~/.ssh</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">chmod</span> 644 ~/.ssh/authorized_keys</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">chmod</span> 644 ~/.ssh/known_hosts</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">chmod</span> 644 ~/.ssh/config</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">chmod</span> 600 ~/.ssh/id_rsa</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">chmod</span> 644 ~/.ssh/id_rsa.pub</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">chmod</span> 600 ~/.ssh/github_rsa</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="fu">chmod</span> 644 ~/.ssh/github_rsa.pub</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="fu">chmod</span> 600 ~/.ssh/mozilla_rsa</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="fu">chmod</span> 644 ~/.ssh/mozilla_rsa.pub</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="selection-des-interfaces-utilisateurs" class="level2">
<h2 class="anchored" data-anchor-id="selection-des-interfaces-utilisateurs">Selection des interfaces utilisateurs</h2>
<p>Par défaut, l’interface graphique est activée et elle consomme beaucoup de ressources. Donc si on ne l’utilise pas, il est conseillé de la désactiver. Malheureusement, lorsqu’elle est désactivée, les disques ne sont pas montés automatiquement lorsqu’on les connecte au RPi.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> raspi-config</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 System Options</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># S5 Boot / Auto Login</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># B2 Console Autologin ou B1 Console</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="vnc" class="level2">
<h2 class="anchored" data-anchor-id="vnc">VNC</h2>
<blockquote class="blockquote">
<p>N.B. Il faut que l’interface graphique soit activée pour que VNC fonctionne (voir § précédent).</p>
</blockquote>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> raspi-config</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 Interfacing Options / I3 VNC &lt;Yes&gt;.</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Si l’option n’est pas visible, il faut</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># installer VNC au préalable avec la commande&nbsp;:</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt-get install realvnc-vnc-server realvnc-vnc-viewer</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Télécharger un client VNC pour se connecter au serveur VNC du rPi. Par exemple RealVNC&nbsp;:</p>
<ul>
<li><a href="https://www.realvnc.com/download/viewer/" class="uri">https://www.realvnc.com/download/viewer/</a>.</li>
</ul>
<blockquote class="blockquote">
<p>N.&nbsp;B. Le client VNC installé par défaut sur macOS ne fonctionne pas pour se connecter au serveur VNC du rPI. L’erreur retournée est<br><em>Le logiciel de l’ordinateur distant semble ne pas être compatible avec cette version de Partage d’écran.</em><br><code>bash /System/Library/CoreServices/Applications/Screen\ Sharing.app</code></p>
</blockquote>
</section>
<section id="enlever-les-programmes-inutiles" class="level2">
<h2 class="anchored" data-anchor-id="enlever-les-programmes-inutiles">Enlever les programmes inutiles</h2>
<p>Enfin, inutiles pour moi….</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">df</span> <span class="at">-h</span> <span class="co"># Pour voir la capacité de la carte SD</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt-get purge wolfram-engine</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt-get purge libreoffice<span class="pp">*</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt-get clean</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt-get autoremove</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">df</span> <span class="at">-h</span> <span class="co"># Vous venez de libérer 1.1 GB&nbsp;!</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="réinstaller-un-programme-quon-croyait-inutile" class="level2">
<h2 class="anchored" data-anchor-id="réinstaller-un-programme-quon-croyait-inutile">Réinstaller un programme qu’on croyait inutile</h2>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt-get <span class="at">--assume-yes</span> update</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt-get <span class="at">--assume-yes</span> install wolfram-engine</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="ajouter-quelques-programmes-utiles" class="level2">
<h2 class="anchored" data-anchor-id="ajouter-quelques-programmes-utiles">Ajouter quelques programmes utiles</h2>
<section id="byobu" class="level3">
<h3 class="anchored" data-anchor-id="byobu">BYOBU</h3>
<p>Byobu (<a href="https://www.byobu.org/" class="uri">https://www.byobu.org/</a>) est un gestionnaire de fenêtres et un multiplexeur de terminal en mode texte sous licence GPLv3. Il a été conçu à l’origine pour apporter des améliorations élégantes au gestionnaire de fenêtres GNU Screen, par ailleurs fonctionnel, simple et pratique, pour la distribution serveur Ubuntu. Byobu comprend maintenant des profils améliorés, des raccourcis clavier pratiques, des utilitaires de configuration et des notifications d’état du système commutables pour le gestionnaire de fenêtres GNU Screen et le multiplexeur de terminal plus moderne Tmux, et fonctionne sur la plupart des distributions Linux, BSD et Mac. Le code source se trouve sur GitHub&nbsp;: <a href="https://github.com/dustinkirkland/byobu" class="uri">https://github.com/dustinkirkland/byobu</a></p>
<p>Dans la terminologie de Byobu, une session est une instance de Byobu en cours d’exécution. Une session se compose d’une collection de fenêtres (<em>windows</em>), qui sont essentiellement des sessions shell, et de volets (<em>panes</em>), qui sont des sous-sections de fenêtre.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt-get install byobu <span class="at">--assume-yes</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="ex">byobu</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Configurer les options de base en pressant sur F1</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Configurer le raccourci de “l’escape sequence”.</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Conseil: utiliser la lettre “B”.</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="ex">Change</span> escape sequence</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Configurer le démarrage automatique de Byobu.</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="ex">Byobu</span> currently does not launch at login <span class="er">(</span><span class="ex">toggle</span> on<span class="kw">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<!--
#### .bash_profile

Pour charger `.bash_profile`, ajouter la commande suivante dans `~/.bashrc` :

```bash
_bash_profile_sourced=1 . ~/.bash_profile 2>/dev/null || true
```
-->
<section id="raccourcis-clavier" class="level4">
<h4 class="anchored" data-anchor-id="raccourcis-clavier">Raccourcis clavier</h4>
<p>Les raccourcis claviers sont définis dans le fichier <code>f-keys.tmux</code> (<a href="https://github.com/dustinkirkland/byobu/blob/master/usr/share/byobu/keybindings/f-keys.tmux">source</a>).</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="ex">/usr/share/byobu/keybindings/f-keys.tmux</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Sur macOS, la majorité des raccourcis n’est utilisable qu’à travers la touche <code>F12</code>. Donc quand l’aide indique la combinaison <code>C-a</code>, il faut la remplacer par <code>F12</code>.</p>
<p>Par exemple,</p>
<ul>
<li><code>F12 %</code> scinde le volet actuel en deux volets verticaux.</li>
<li><code>F12 |</code> scinde le volet actuel en deux volets horizontaux.</li>
</ul>
<p>La liste de toutes les fonction <code>F12</code> est disponible avec la commande <code>F12 ?</code>.</p>
<p>Ci-dessous, la liste des raccourcis autres que <code>F12</code>.</p>
<!--
| Label | Key     |
| ----- | ------- |
| C     | Control |
| S     | Shift   |
| M     | Meta    |
-->
<table class="table">
<thead>
<tr class="header">
<th>Key</th>
<th>Action</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>F1</td>
<td>configuration menu</td>
</tr>
<tr class="even">
<td>F2</td>
<td>new window</td>
</tr>
<tr class="odd">
<td>F3</td>
<td>previous window</td>
</tr>
<tr class="even">
<td>F4</td>
<td>next window</td>
</tr>
<tr class="odd">
<td>F5</td>
<td>refresh menu bar status notifications</td>
</tr>
<tr class="even">
<td>F6</td>
<td>detach</td>
</tr>
<tr class="odd">
<td>F7</td>
<td>—</td>
</tr>
<tr class="even">
<td>F8</td>
<td>rename window</td>
</tr>
<tr class="odd">
<td>F9</td>
<td>configuration menu</td>
</tr>
<tr class="even">
<td>F10</td>
<td>—</td>
</tr>
<tr class="odd">
<td>F11</td>
<td>—</td>
</tr>
<tr class="even">
<td>F12</td>
<td>—</td>
</tr>
<tr class="odd">
<td>ctrl-D</td>
<td>kill window</td>
</tr>
</tbody>
</table>
</section>
<section id="à-lire" class="level4">
<h4 class="anchored" data-anchor-id="à-lire">À lire</h4>
<ul>
<li><a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-use-byobu-for-terminal-management-on-ubuntu-16-04" class="uri">https://www.digitalocean.com/community/tutorials/how-to-install-and-use-byobu-for-terminal-management-on-ubuntu-16-04</a></li>
<li><a href="https://superuser.com/a/818753/508141" class="uri">https://superuser.com/a/818753/508141</a></li>
</ul>
</section>
</section>
<section id="ipython" class="level3">
<h3 class="anchored" data-anchor-id="ipython">iPython</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python3</span> <span class="at">-m</span> pip install ipython</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="tmux" class="level3">
<h3 class="anchored" data-anchor-id="tmux">TMUX</h3>
<blockquote class="blockquote">
<p>N.B. Ce chapitre est ici pour référence. Je n’utilise plus Tmux directement, mais à travers <a href="#byobu">Byobu</a>.</p>
</blockquote>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt <span class="at">--assume-yes</span> install tmux</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="ex">tmux</span> <span class="co"># crée et démarre un nouveau shell</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="ex">tmux</span> new <span class="at">-s</span> session_name  <span class="co"># idem mais avec un nom de session</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="ex">tmux</span> detach <span class="co"># pour se détacher du shell en cours</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ctrl-B S # liste les shells tmux</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ctrl-B D # revient au shell principal</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="ex">tmux</span> ls <span class="co"># liste les shells tmux</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="ex">tmux</span> a <span class="at">-t</span> 0 <span class="co"># revient au shell tmux 0</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="ex">tmux</span> a <span class="co"># revient au dernier shell utilisé</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="bu">exit</span> <span class="co"># quitte et détruit le shell en cours</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="ex">tmux</span> kill-session <span class="at">-t</span> 0 <span class="co"># détruit une session détachée</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Par défaut, la roulette de la souris fait défiler</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="co"># l’historique des commandes. Pour que la roulette</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="co"># fasse défiler l’écran, il faut éditer le fichier</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="co"># ~/.tmux.conf</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="fu">nano</span> ~/.tmux.conf</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="co"># et ajouter le paramètre</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="ex">set-option</span> <span class="at">-g</span> mouse on</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Il ne s’appliquera qu’aux nouveaux shells et pas</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="co"># aux shells existants, mais on peut le faire dans</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="co"># chaque shell individuel avec la commande</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a><span class="ex">tmux</span> set-option <span class="at">-g</span> mouse on</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="co"># En mode mouse on, il n’est possible de sélectionner</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a><span class="co"># du texte. Il faut donc revenir en mode off.</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a><span class="ex">tmux</span> set-option <span class="at">-g</span> mouse off</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="gnu-screen" class="level3">
<h3 class="anchored" data-anchor-id="gnu-screen">GNU screen</h3>
<blockquote class="blockquote">
<p>Je préfère ne pas utiliser GNU screen, mais parfois… on a pas le choix.</p>
</blockquote>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt-get <span class="at">--assume-yes</span> install screen</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"shell -</span><span class="va">$SHELL</span><span class="st">"</span> <span class="op">&gt;</span> ~/.screenrc <span class="co"># Pour que screen lise .bash_profile</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="ex">screen</span> <span class="co"># Démarre un nouveau shell</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ctrl-A ctrl-D # revient au shell principal</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="ex">screen</span> <span class="at">-ls</span> <span class="co"># liste des shells</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="ex">screen</span> <span class="at">-r</span> xxxx <span class="co"># xxxx = no du shell que l’on veut activer</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ctrl-A K # arrête le shell en cours</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="ex">screen</span> <span class="at">-X</span> <span class="at">-S</span> xxxx quit <span class="co"># quitte le shell no xxxx</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="ex">screen</span> <span class="at">-X</span> <span class="at">-S</span> xxxx kill <span class="co"># arrête le shell no xxxx</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co"># RS232</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="ex">python3</span> <span class="at">-m</span> serial.tools.list_ports</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="ex">screen</span> /dev/ttyACM0 115200</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="co"># ctrl-A K # pour arrêter la transmission série</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="partager-un-espace-disque-avec-samba" class="level2">
<h2 class="anchored" data-anchor-id="partager-un-espace-disque-avec-samba">Partager un espace disque avec samba</h2>
<blockquote class="blockquote">
<p>Source&nbsp;: <a href="https://raspberrypihq.com/how-to-share-a-folder-with-a-windows-computer-from-a-raspberry-pi/" class="uri">https://raspberrypihq.com/how-to-share-a-folder-with-a-windows-computer-from-a-raspberry-pi/</a></p>
</blockquote>
<section id="sur-le-raspberry" class="level3">
<h3 class="anchored" data-anchor-id="sur-le-raspberry">Sur le Raspberry</h3>
<p>Installer samba</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt-get <span class="at">--assume-yes</span> install samba samba-common-bin</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Éditer la configuration</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> nano /etc/samba/smb.conf</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Vérifier la présence des informations suivantes&nbsp;:</p>
<pre class="conf"><code>workgroup = WORKGROUP
wins support = yes</code></pre>
<p>À la fin du fichier, ajouter les informations suivantes&nbsp;:</p>
<pre class="conf"><code># Source
# https://raspberrypihq.com/how-to-share-a-folder-with-a-windows-computer-from-a-raspberry-pi/
[PiShare]
comment = Raspberry Pi Share
path = /home/pi
browseable = yes
writeable = yes
only guest = no
create mask = 0777
directory mask = 0777
public = no</code></pre>
<p>Le flag <code>public = no</code> indique que l’accès en temps qu’invité est désactivé. Si on le change en <code>public = yes</code>, le disque est partagé en lecture seule.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> smbpasswd <span class="at">-a</span> pi <span class="co"># Pour changer le mot de passe.</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="monter-le-disque-partagé-sur-macos" class="level3">
<h3 class="anchored" data-anchor-id="monter-le-disque-partagé-sur-macos">Monter le disque partagé sur macOS</h3>
<p>Dans le Finder&nbsp;:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="ex">⌘</span> K</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="ex">smb://pi@raspberrypi.local</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="monter-le-disque-partagé-sur-windows" class="level3">
<h3 class="anchored" data-anchor-id="monter-le-disque-partagé-sur-windows">Monter le disque partagé sur Windows</h3>
<p>Voir</p>
<ul>
<li><a href="https://support.microsoft.com/fr-ch/help/4026635/windows-map-a-network-drive" class="uri">https://support.microsoft.com/fr-ch/help/4026635/windows-map-a-network-drive</a></li>
</ul>
<p>On peu aussi entrer le chemin d’accès au Raspberry au <a href="https://en.wikipedia.org/wiki/Path_(computing)#Universal_Naming_Convention">format UNC</a> directement dans la barre d’adresse de l’explorateur Windows (raccourcis Win+E, Ctrl+L).</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="ex">\\raspberrypi.local</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Si la résolution du nom d’hôte ne fonctionne pas, on peut aussi utiliser l’adresse IP&nbsp;:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="ex">\\192.168.1.240</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="installer-une-autre-version-de-python-3" class="level3">
<h3 class="anchored" data-anchor-id="installer-une-autre-version-de-python-3">Installer une autre version de Python&nbsp;3</h3>
<blockquote class="blockquote">
<p>Les informations de ce chapitre sont passablement obsolètes car les dernières versions de l’OS du rPi intègrent des versions de Python supérieures à 3.6. Donc avant d’installer une nouvelle version de Python&nbsp;3, il est prudent de vérifier la version installée sur le Raspberry avec la commande</p>
</blockquote>
<div class="sourceCode" id="cb28"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python3</span> <span class="at">--version</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<blockquote class="blockquote">
<p>On peut aussi vérifier la version de l’OS avec la commande</p>
</blockquote>
<div class="sourceCode" id="cb29"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> /etc/os-release</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<blockquote class="blockquote">
<p>Édit du 16 octobre 2019&nbsp;: Raspbian Buster intègre la version 3.7.3 de Python. Édit du 11 février 2023&nbsp;: Raspberry Pi OS Bullseye 64&nbsp;bit intègre la version 3.9.2 de Python.</p>
</blockquote>
<p>Raspbian Stretch propose la version 3.5 de Python. Comme Python&nbsp;3.6 apporte de nouvelles fonctionnalités comme les <em>f-strings</em> et que le module <code>asyncio</code> a été amélioré, je pense que c’est intéressant de l’installer aussi. L’idée est aussi de pouvoir tester le module <a href="https://gitlab.com/pgjones/quart">quart</a>.</p>
<p>Source&nbsp;: <a href="https://liftcodeplay.com/2017/06/30/how-to-install-python-3-6-on-raspbian-linux-for-raspberry-pi/" class="uri">https://liftcodeplay.com/2017/06/30/how-to-install-python-3-6-on-raspbian-linux-for-raspberry-pi/</a> Les versions de Python disponibles sont téléchargeables à&nbsp;: <a href="https://www.python.org/ftp/python/" class="uri">https://www.python.org/ftp/python/</a> Temps d’installation&nbsp;: environ 30&nbsp;min. Cette procédure n’écrase pas les versions de Python existantes.</p>
<p>Cette procédure montre comment installer Python 3.6.7.</p>
<blockquote class="blockquote">
<p>J’ai aussi essayé d’installer la version 3.7.1 et l’installation a réussi, mais malheureusement pip ne fonctionnait pas, donc il m’était impossible d’installer de nouveaux modules.</p>
</blockquote>
<div class="sourceCode" id="cb30"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt-get <span class="at">--assume-yes</span> install build-essential checkinstall</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt-get <span class="at">--assume-yes</span> install libreadline-gplv2-dev libncursesw5-dev libssl-dev libsqlite3-dev tk-dev libgdbm-dev libc6-dev libbz2-dev</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> ~/temp <span class="kw">&amp;&amp;</span> <span class="bu">cd</span> ~/temp</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> https://www.python.org/ftp/python/3.6.7/Python-3.6.7.tgz</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> tar xzf Python-3.6.7.tgz</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> Python-3.6.7</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> <span class="at">-s</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="va">TIMEFORMAT</span><span class="op">=</span><span class="st">'time : %E'</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="bu">time</span> <span class="er">(</span><span class="fu">bash</span> configure <span class="kw">&amp;&amp;</span> <span class="fu">make</span> <span class="at">-j4</span> altinstall<span class="kw">)</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="bu">exit</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ~ <span class="kw">&amp;&amp;</span> <span class="fu">sudo</span> rm <span class="at">-rf</span> temp</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Créer un lien pour que Python 3.6 soit la version de Python 3 par défaut. Ceci nous permettra d’indiquer le <em>shebang</em> <code>#!/usr/bin/env python3</code> au début des scripts et de les exécuter avec la commande <code>python3 &lt;nom_du_script.py&gt;</code>.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span> python3.6 <span class="co"># /usr/local/bin/python3.6</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="ex">python3.6</span> <span class="at">-V</span> <span class="co"># Python 3.6.7</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> ln <span class="at">-sf</span> /usr/local/bin/python3.6 /usr/local/bin/python3</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="ex">/usr/bin/env</span> python3 <span class="at">-V</span> <span class="co"># Python 3.6.7</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span> python3 <span class="co"># /usr/local/bin/python3</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Pour installer des modules</p>
<blockquote class="blockquote">
<p>Si <code>pip install &lt;module&gt;</code> ne fonctionne pas, on peut utiliser les commandes suivantes&nbsp;:</p>
</blockquote>
<div class="sourceCode" id="cb32"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> python3.6 <span class="at">-m</span> pip install <span class="at">--upgrade</span> pip</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> python3.6 <span class="at">-m</span> pip install quart</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="picocom" class="level3">
<h3 class="anchored" data-anchor-id="picocom">picocom</h3>
<p>Picocom est un terminal série.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt-get <span class="at">--assume-yes</span> install picocom</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="ex">picocom</span> <span class="at">-b</span> 115200 <span class="at">-p</span> 1 <span class="at">-c</span> /dev/tty</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Pour pouvoir l’utiliser sans être sudoer, il faut que l’utilisateur courant fasse partie du groupe dialout (et peut-être des groupes plugdev et input, je ne suis plus sûr). Il faut redémarrer le rPi pour que le changement soit pris en compte.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> usermod <span class="at">-a</span> <span class="at">-G</span> dialout <span class="va">$USER</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> usermod <span class="at">-a</span> <span class="at">-G</span> plugdev <span class="va">$USER</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> usermod <span class="at">-a</span> <span class="at">-G</span> input <span class="va">$USER</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> reboot</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="torsocks" class="level3">
<h3 class="anchored" data-anchor-id="torsocks">torsocks</h3>
<p>Torsocks permet d’utiliser le réseau Tor en ligne de commande, autrement dit, il permet de “torifier” la ligne de commande.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt-get install torsocks <span class="at">--assume-yes</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="va">ANS</span><span class="op">=</span><span class="va">$(</span><span class="ex">torsocks</span> wget <span class="at">-qO-</span> https://check.torproject.org/api/ip<span class="va">)</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$ANS</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># {"IsTor":true,"IP":"××.××.××.××"}</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="youtube-dl" class="level2">
<h2 class="anchored" data-anchor-id="youtube-dl">YouTube-DL</h2>
<div class="sourceCode" id="cb36"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python3</span> <span class="at">-m</span> pip install <span class="at">--force-reinstall</span> https://github.com/yt-dlp/yt-dlp/archive/master.tar.gz</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="arrêter-ou-redémarrer-un-raspberry" class="level2">
<h2 class="anchored" data-anchor-id="arrêter-ou-redémarrer-un-raspberry">Arrêter ou redémarrer un Raspberry</h2>
<p>Ce n’est pas une bonne idée de juste tirer la prise quand on veut arrêter ou redémarrer son Raspberry. En effet, au bout de quelque temps, le système se retrouve avec un grand nombre de fichiers partiels et probablement illisibles. Si des fichiers importants sont touchés, le Raspberry peut devenir inutilisable.</p>
<p>Donc pour éteindre un Raspberry, on utilisera une des commandes ci-dessous. La différence entre elles n’est pas aussi évidente qu’il y parait (voir <a href="https://unix.stackexchange.com/a/196471/199660" class="uri">https://unix.stackexchange.com/a/196471/199660</a>). Seule la commande <code>halt</code> éteint la LED rouge d’alimentation, donc je suppose que c’est celle qu’il faut privilégier.</p>
<blockquote class="blockquote">
<p>N.&nbsp;B. Attention, aucune de ces commandes ne coupe l’alimentation de la carte ou l’alimentation des ports USB. Donc ce n’est pas une bonne option pour éjecter un disque externe par exemple.</p>
</blockquote>
<div class="sourceCode" id="cb37"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> halt</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> poweroff</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> shutdown <span class="at">-h</span> now <span class="at">--poweroff</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Et pour redémarrer un Raspberry, on utilisera une des commandes suivantes</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> reboot</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> shutdown <span class="at">-r</span> now</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="lire-un-disque-externe" class="level2">
<h2 class="anchored" data-anchor-id="lire-un-disque-externe">Lire un disque externe</h2>
<p>Lorsqu’on connecte un disque externe, il est automatiquement accessible au chemin <code>/media/pi/nom_du_disque</code>. Ce chemin est ausi appelé <em>point de montage</em>. On peut le voir avec la commande <code>ls</code> et accéder aux répertoires avec la commande <code>cd</code>. Dans l’exemple ci-dessous, le disque externe s’appelle <code>LaCie</code>. Ce nom changera avec d’autres fabricants ou si plusieurs disques du même fabricant sont utilisés en même temps. Il faut tenir compte de ce fait lorsqu’on écrit des scripts et des programmes qui utilisent le chemin du point de montage.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-l</span> /media/pi/</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> /media/pi/LaCie</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="éjecter-un-disque-externe" class="level2">
<h2 class="anchored" data-anchor-id="éjecter-un-disque-externe">Éjecter un disque externe</h2>
<blockquote class="blockquote">
<p>N.B. À proprement parler, seuls les médias comme les CD où les bandes peuvent être éjectés. Mais le terme est aussi utilisé pour les autres médias.</p>
</blockquote>
<p>Éjecter un média est un peu plus compliqué que de le connecter et l’utiliser. En effet, sur un Raspbery ou n’importe quel <a href="https://fr.wikipedia.org/wiki/Type_Unix">système *nix</a>, il faut comprendre trois notions&nbsp;:</p>
<ul>
<li>Les disques</li>
<li>Les partitions</li>
<li>Les points de montage</li>
</ul>
<p>Pour explorer ces concepts, utilisons la commande <code>lsblk</code>.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="ex">lsblk</span> <span class="at">--output</span> NAME,PATH,RM,RO,ROTA,TYPE,SIZE,FSAVAIL,MOUNTPOINT</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb41"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="ex">NAME</span>        PATH           RM RO ROTA TYPE  SIZE FSAVAIL MOUNTPOINT</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="ex">sda</span>         /dev/sda        0  0    1 disk  4.5T</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="ex">├─sda1</span>      /dev/sda1       0  0    1 part  200M</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="ex">└─sda2</span>      /dev/sda2       0  0    1 part  4.5T      1T /media/pi/LaCie</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="ex">mmcblk0</span>     /dev/mmcblk0    0  0    0 disk 29.7G</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="ex">├─mmcblk0p1</span> /dev/mmcblk0p1  0  0    0 part  256M  201.8M /boot</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="ex">└─mmcblk0p2</span> /dev/mmcblk0p2  0  0    0 part 29.5G     24G /</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Les résultats affichés par la commande <code>lsblk</code>ci-dessus montrent deux disques appelés <code>sda</code>et <code>mmcblk0</code>. Ils ont chacun deux partitions <code>sda1</code>, <code>sda2</code>, <code>mmcblk0p1</code> et <code>mmcblk0p2</code>. Et ils ont chacun un ou deux points de montage <code>/media/pi/LaCie</code>, <code>/boot</code> et <code>/</code>. On peut différencier les disques des partitions dans le dessin de la structure hiérarchique de la première colonne NAME et aussi dans la colonne TYPE.</p>
<p>L’éjection du disque se passe en deux étapes&nbsp;:</p>
<ol type="1">
<li>Démonter ses points de montage. Dans le cas présenté, il n’en a qu’un qui est monté à <code>/media/pi/LaCie</code>, mais dont la référence se trouve à <code>/dev/sda2</code>.</li>
<li>Couper l’alimentation du disque. La référence du disque lui-même se trouve à <code>/dev/sda</code>.</li>
</ol>
<blockquote class="blockquote">
<p>N.B. Il faut s’assurer que le disque n’est plus utilisé, sinon le système refusera de le démonter avec l’erreur <code>target is busy</code>. C’est à ça que sert le changement de répertoire ci-dessous.</p>
</blockquote>
<div class="sourceCode" id="cb42"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="ex">udisksctl</span> unmount <span class="at">--block-device</span> /dev/sda2</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> udisksctl power-off <span class="at">--block-device</span> /dev/sda</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<!--
### Monter un disque externe

Si le Raspberry est configuré pour démarrer en mode _Desktop Autologin_ (`sudo raspi-config # options 1 + S5 + B4`), les disques externes sont automatiquement montés par le système et il n’y a donc pas besoin de s’en occuper. Ceci est valable même si on ne se con
Par contre s’il est configuré pour démarrarer en mode _Text console_ (`sudo raspi-config # options 1 + S5 + B1 ou B2`), les points de montages sont créés

https://raspberrypi.stackexchange.com/questions/141161/automatically-mount-usb-storage-on-raspberry-os-bullseye-lite-as-desktop-versio

Voici quelques explications sur ces informations.

- Les disques durs standards sont nommés avec le préfixe `sd`suivi d’une lettre attribuée dans l’ordre alphabétique. Donc le premier disque aura le nom `sda`, le deuxième `sdb`, etc.
  L’acronyme `sd`signifie *SCSI mass-storage driver*. Ici, c’est le pilote qui est SCSI, même si le disque n’est pas SCSI.
- Les stockages NVMe (Non-Volatile Memory Express) sont nommés avec le préfix `nvm`.
- Les stockages MMC (Multi Media Card) sont nommés avec le préfix `nvm`.
 -->
<section id="pour-aller-plus-loin" class="level3">
<h3 class="anchored" data-anchor-id="pour-aller-plus-loin">Pour aller plus loin</h3>
<ul>
<li><a href="https://linuxbsdos.com/2021/11/27/what-you-need-to-know-about-disks-and-disk-partitions-in-linux/">What you need to know about disks and disk partitions in Linux</a>.</li>
<li><a href="https://www.kingston.com/en/ssd/what-is-nvme-ssd-technology">What is NVMe SSD technology?</a></li>
<li><a href="https://recoverit.wondershare.com/memorycard-recovery/what-is-mmc-card.html">What Is an MMC Card - Full Guide</a></li>
</ul>
</section>
</section>
<section id="à-voir-aussi" class="level2">
<h2 class="anchored" data-anchor-id="à-voir-aussi">À voir aussi</h2>
<ul>
<li><a href="https://www.raspberrypi.com/news/raspberry-pi-bullseye-update-april-2022/" class="uri">https://www.raspberrypi.com/news/raspberry-pi-bullseye-update-april-2022/</a></li>
<li><a href="https://learnxinyminutes.com/docs/bash/" class="uri">https://learnxinyminutes.com/docs/bash/</a></li>
<li><a href="https://devhints.io/bash" class="uri">https://devhints.io/bash</a></li>
<li><a href="https://www.gnu.org/software/bash/manual/html_node/Bourne-Shell-Builtins.html" class="uri">https://www.gnu.org/software/bash/manual/html_node/Bourne-Shell-Builtins.html</a></li>
</ul>
<!-- Liens transmis par Johannes -->
<ul>
<li><a href="https://funprojects.blog/2021/04/26/control-usb-powered-devices/" class="uri">https://funprojects.blog/2021/04/26/control-usb-powered-devices/</a></li>
<li><a href="https://raspberrypi.stackexchange.com/questions/118656/raspberry-pi4-uhubctl-bash-script-wont-run" class="uri">https://raspberrypi.stackexchange.com/questions/118656/raspberry-pi4-uhubctl-bash-script-wont-run</a></li>
<li><a href="https://github.com/codazoda/hub-ctrl.c/issues/17" class="uri">https://github.com/codazoda/hub-ctrl.c/issues/17</a></li>
</ul>
</section>
<section id="quelques-commandes-utiles" class="level2">
<h2 class="anchored" data-anchor-id="quelques-commandes-utiles">Quelques commandes utiles</h2>
<ul>
<li>Déterminer le modèle de Raspberry</li>
</ul>
<div class="sourceCode" id="cb43"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> /sys/firmware/devicetree/base/model</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Raspberry Pi 4 Model B Rev 1.1</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Déterminer la version de l’OS</li>
</ul>
<div class="sourceCode" id="cb44"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> /etc/os_release</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>


</section>

<p>© ouilogique.com</p></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<script src="../../js/file_list.js"></script>
<script src="../../js/prev_next_buttons.js"></script>
<script src="../../js/target_blank.js"></script>




</body></html>